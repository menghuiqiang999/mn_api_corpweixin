'use strict'
const pageName = 'test_decrypto_msg_pkcs7';

//var encrypted  = 'cIMFY2XtkZ+GiHUQ0tlT009jMzvzo+g1bKIsSWBrYUJV6DUkrSDNyU/ZAM6v21+75LxHN9aKsOOXp32bwG1btK1XJsuJZiuMl1515DyZG2VWuGKJYYsQcdeX9fdm3fBwEv1wBtf5u79wA8ybDW2en+BF4JCsHg6+bQtP8dtKNDXbaqe1B2hcWqJ33OJa7zizg1pND8yp+izYInyMm54ShYKjg4Lw+JA5KkqP17AgGJh2LUP+LpjaWduyDaY4san9ia0lGMyEIMCrRzaSvlUQg4aUxhfdX4mqLMtf0fLIqV/uNxrjwuueYmMhYXeCcZqUAotw/DMvBtnSV/3c+JQ2aE7fsx4X3PfTtVg2EMU5OuqOSzly3XDxY7xkGwzsxic7H5s5dYMstGg5iFHwZRfiAYa4m3yE0FYdmwtns6JG7/8==';


//var encrypted = 'sBJ/ttntveYnAjdNR4PK1/SgShoB8b9mkgkbkWyQbhp8/gjEkToRpa57WHQV54IzHURopb4mjeidF2RkmZ7KcF2PQh4jnT2h/eM7nmO08ZRHDe9LCl/fC3zJKu7iG+G1FI2uXrL5750vaCSAJGk/Yfm58AHTsFvd4KE9tH68/CpcFtcAUp7p1pODbdIK3qTi6cIR8TjEqyLreRuGQzcqwsp8wp0WYEugR40UKqvqrDcekBMFTQya7DoIwc2+8gphn//Y1m6R1/aqFAOtDhP1GnQuaKeHGWgbc8X41wQ71FGOjdiQSAYPBaciKk5GnkscdLfVOOEVnjjZbYaqFi1WESBJIpN1p0DQ6mbl8+LcWKMWY5MslabXhYclay8MzhNuROeu8tfNgRaeQXv4aqqOt+8pN53UjoBi4x9zyFQ1ta9/umpAjomxT5n7g6xISPyzY2Ci1awE2tWFro+u4dptPQ==';
//var encrypted = 'X5zzo2c6lUyXIUG2jyrTh+LVTWSuhJdcdXksMuJxs8OM4tLkgmqYHqkLtGwR8d6K5bGRwuh2TrRHonQoTMLXtWxBFwJO5kJUzjGlOUTyF9LCSEus5JZ6qto9H88DOh/WDLr8kT/w4q94sSEnrXp1fgAk8JBu7+B+Aa90ZAheqq5dQwxsEpH5YvURSzw3S6Ept9GYKA0PaLHZ+diMX6gDMg4fGwkV/hUsPEHycA2HSCEn2o8P3bNURDhlRMie6DkH364RSW9MRffAVh7Go0hqGrJM3UpEWs0XpWHXXzoX+1Z3+d16TXautmwkj8YHvyGTPPo/0DOlXtH1OSnQMyoU9J5CxJA0p11qtCS5/NPvVziQ9zMUK+k+lzlhGUnnpme6q4c+Y0fAN5eBiC7p5AIiWXnZg+5R1ygBoUD1jukRw5Ryh+T7QcBZaUwQC/w63Og3VY0ZLqcH1AgrFCrB5HjgbQ==';
//["8XWUO2H30ex0C+wPAep1dNQNOrMT9vOWZnNNvrMbJEcii9azqP9fzsltWe9deEkYmatj7BhgHoO7o8KCLZAK6Wg39k3tOMKmVJRzu6/aB9FYgk80DpzWvQJA4i8J57XBuW9I1agJLyNTz9i6RLDXATxOj7S80u+TPbsyM2lOXFaD+/Q+OQ9std+23i2dhWVn2nyc58K756DX3f6vZ3qf+7+gtL0YztKTI+aGyIvMLKKtvSsdUhv1anxvqSAkOjTmy33kG/FO3f9M+r0yS7e9bJnHTKZVpGc5C4iQVRguJL6LPYgJwFM1UQx3OEWCuiTXX5MPe28oAd9hxjMU5ZTPyknYCg7C/mH7KsAnNir0WtuU9vj3EMwlEonuQmzzMxAshZJqjwq2AoxR2FSO9yqJUBZ23+JzPlMXGLE5chAYcHSYvDChsLZVDYjdbi2I+xBPqC4owz8qENGKUtci63AkHg==
//var encrypted ='8XWUO2H30ex0C+wPAep1dNQNOrMT9vOWZnNNvrMbJEcii9azqP9fzsltWe9deEkYmatj7BhgHoO7o8KCLZAK6Wg39k3tOMKmVJRzu6/aB9FYgk80DpzWvQJA4i8J57XBuW9I1agJLyNTz9i6RLDXATxOj7S80u+TPbsyM2lOXFaD+/Q+OQ9std+23i2dhWVn2nyc58K756DX3f6vZ3qf+7+gtL0YztKTI+aGyIvMLKKtvSsdUhv1anxvqSAkOjTmy33kG/FO3f9M+r0yS7e9bJnHTKZVpGc5C4iQVRguJL6LPYgJwFM1UQx3OEWCuiTXX5MPe28oAd9hxjMU5ZTPyknYCg7C/mH7KsAnNir0WtuU9vj3EMwlEonuQmzzMxAshZJqjwq2AoxR2FSO9yqJUBZ23+JzPlMXGLE5chAYcHSYvDChsLZVDYjdbi2I+xBPqC4owz8qENGKUtci63AkHg==';

//const encrypted = 'L56LYOPe/h47u//obk1cR4TphAkTwShUP7L685sMJjZAWMJIa08ULBK1ZQW+hPm3wfYCisuTMe6MmgFh3AM4+fbvoy9+L2/YiPjEBqL/sZf3xzsNSs+us6bZc4pw1qJ9BY+irizvsy6U2wWd4vzEBE0fJDXOh2bZzLNeeT1mF4ILeIxWMi/ylFEvJhvGsbjF7WqPsJ0nUpaTaqr42Jfw9ab5h4Bg/QYTjdsUx5jkyMrdrlBYWKRu2aIF8TlFuJzYrfsADPg3EQz8V+fNt/BM9hEWouNGe2KTLNWsy2YrCczkSOHiCNxTX5tmMVm1ODmkgWbDCi6JM2yD2S+w2j87B8r5qzdk0cKbRrgnMDSRHMvHUlMNoJ8QZidtMa7ojRMid/sl6YR1Ixpizw5A2jRp5Jp5k3DC92n3SYgjr3KHYbDjAgMgLbTGFMiQtnHq4dBpXTRCJM3dyB2gpmDbsQpesGK/r5t19CWoSOEpRpVi2hIJws9ikE66DPbI6tlsmROwJsIyMY0BrFQdTHbxb3vRqZ2rJt9pESGTut32BUpGVAxgzrI9cat4NgDaYcOttzHSeHowM9ZSbsGQu5PCpMOJAN8G52HluU2LxElDMlI1ymwjGFDTdMc92Cw5xGUzsjFjfTuUWHMyIVlCi/f6qD8JA8DW1AnEtFvNy0cfZDtgZAs=';
const encrypted = 'rrk6wSYhdTiwsarNL+UCsS43cavvBaNmGvdqo5ni4bhnZ4ipDchNuDw/s1xOiVfQG5dbL4ZNdpsCDloW64eF3uyw43jW8f0VeqmFG4fxTOjEOay2U7sjqcCDeNK8kfOG/WqvFCtP5IbhEQEg7y1jYThCCdCjmIKF8a8RsbDzFP/oVYfExHY/CMmQYrigCsyO0q81xIVslbeO7CdM2QW4zhN7gBW1xcX0zDwxz1xZKydi+0f0flOFy9UJaGMvauQrvMAg89FNt4/kv2dUEmLqnQXew5F3ewD9hX/BhWXI/HkX2VLxmZCn5NruPd0kQd670ZBO1xiR3QnS8yxfvDIsAY8Nlu+9r9dNCTdbNSGziwAZIctq8mZXGeVQadF1XCqR6BbHJqW2aMoEgadYO3e2SpE12xFT4m+xWsTRbk8oF1k=';



const corpId = "wwf54870d97f9ee496";   //企业微信：深圳XX公司
//var corpsecret = "g3_EqQQtTvWMaOi7HoWZ4-0oqDExr9i3-D-QcXc7Un4";   //通讯录
const corpSecret="wE12G6DxXXDGI71khHpEaOBBRulpX4hqwCqBDkOLTM8"; //机器人
const token = 'moonlight';

const encodingAesKey = 'tu11ooBABHM7AToEQkEyYsKKOyHvvahhWROnyrPXlUC';


const corpInfo = {
    corpId : corpId ,
    corpSecret : corpSecret ,
    token : token ,
    encodingAesKey : encodingAesKey
};


const sub_lib = require('./lib/sub_lib');

const decrypto = sub_lib.aesMsg.decryptoMsgPkcs7;

const [err,msg]=decrypto(corpInfo,encrypted);

if (err) {
    return console.log(err);
}
console.log(msg);